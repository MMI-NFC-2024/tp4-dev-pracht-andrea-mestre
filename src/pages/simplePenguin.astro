---
import Layout from "../layouts/Layout.astro";
import Menu from "../components/Menu.astro";
---

<Layout>
    <Menu />
    
    <!-- En-t√™te de la page -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">
                üìä Visualisation Simple des Pingouins
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                D√©couvrez la relation entre la longueur et la profondeur du bec 
                de tous les pingouins du dataset Palmer Penguins
            </p>
        </div>

        <!-- Statistiques rapides -->
        <div class="flex justify-center gap-6 mb-8">
            <div class="bg-blue-50 rounded-lg px-4 py-3 text-center">
                <div class="text-2xl font-bold text-blue-600" id="total-count">-</div>
                <div class="text-sm text-gray-600">Pingouins</div>
            </div>
            <div class="bg-green-50 rounded-lg px-4 py-3 text-center">
                <div class="text-2xl font-bold text-green-600">3</div>
                <div class="text-sm text-gray-600">Esp√®ces</div>
            </div>
            <div class="bg-purple-50 rounded-lg px-4 py-3 text-center">
                <div class="text-2xl font-bold text-purple-600">3</div>
                <div class="text-sm text-gray-600">√éles</div>
            </div>
        </div>

        <!-- Conteneur principal du graphique -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-2">
                    Longueur vs Profondeur du Bec
                </h2>
                <p class="text-gray-600">
                    Chaque point repr√©sente un pingouin, color√© selon son esp√®ce
                </p>
            </div>
            
            <!-- Zone du graphique -->
            <div id="myplot" class="flex justify-center items-center min-h-[500px]"></div>
        </div>

        <!-- Informations sur les esp√®ces -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-6 border-l-4 border-red-400">
                <h3 class="text-lg font-semibold text-red-800 mb-2">üêß Adelie</h3>
                <p class="text-red-700 text-sm">
                    Les pingouins Adelie sont les plus nombreux dans le dataset. 
                    Ils se caract√©risent par un bec relativement court et profond.
                </p>
            </div>
            
            <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 border-l-4 border-green-400">
                <h3 class="text-lg font-semibold text-green-800 mb-2">üêß Chinstrap</h3>
                <p class="text-green-700 text-sm">
                    Les pingouins Chinstrap ont un bec plus long que les Adelie 
                    et sont facilement reconnaissables √† leur "mentonni√®re".
                </p>
            </div>
            
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border-l-4 border-blue-400">
                <h3 class="text-lg font-semibold text-blue-800 mb-2">üêß Gentoo</h3>
                <p class="text-blue-700 text-sm">
                    Les pingouins Gentoo sont les plus grands et ont le bec 
                    le plus long. Ils sont excellents nageurs.
                </p>
            </div>
        </div>
    </div>

    <script>
        import * as Plot from "@observablehq/plot";
        import penguins from "../assets/penguins.json";

        function createPlot() {
            const validData = penguins.filter(d => 
                d.culmen_length_mm && d.culmen_depth_mm && d.species
            );

            const countElement = document.getElementById("total-count");
            if (countElement) {
                countElement.textContent = validData.length;
            }

            const plot = Plot.plot({
                marks: [
                    Plot.dot(validData, {
                        x: "culmen_length_mm",
                        y: "culmen_depth_mm",
                        stroke: "species",
                        fill: "species",
                        fillOpacity: 0.7,
                        r: 4,
                        strokeWidth: 2
                    }),
                ],
                marginLeft: 70,
                marginBottom: 70,
                marginTop: 40,
                marginRight: 40,
                width: 800,
                height: 500,
                x: {
                    label: "Longueur du bec (mm)",
                    grid: true,
                    tickFormat: d => `${d} mm`
                },
                y: {
                    label: "Profondeur du bec (mm)",
                    grid: true,
                    tickFormat: d => `${d} mm`
                },
                color: {
                    legend: true,
                    label: "Esp√®ce",
                    range: ["#ef4444", "#22c55e", "#3b82f6"] // Rouge, Vert, Bleu
                },
                style: {
                    fontSize: "14px",
                    fontFamily: "system-ui, sans-serif"
                }
            });
            
            const div = document.querySelector("#myplot");
            if (div) {
                div.appendChild(plot);
            }
        }
        createPlot();
    </script>

    <style>
      
        .bg-white {
            transition: box-shadow 0.3s ease;
        }
        
        .bg-white:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Style responsive pour le graphique */
        #myplot svg {
            max-width: 100%;
            height: auto;
        }
        
        /* Animations des cartes d'esp√®ces */
        .grid > div {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .grid > div:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .max-w-6xl {
                padding: 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .flex {
                flex-direction: column;
                gap: 1rem;
            }
            
            .flex > div {
                text-align: center;
            }
        }
    </style>
</Layout>
